<!DOCTYPE html>

<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>Simulateur heures suppl√©mentaires</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="manifest" href="./manifest.json">
  <meta name="theme-color" content="#4FB3C2">
  <link rel="apple-touch-icon" href="/hs/apple-touch-icon.png">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-title" content="Compteur Heures & Paie">

  <style>
    *, *::before, *::after { box-sizing: border-box; }

    body {
      margin: 0;
      background: #4FB3C2;
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
      display: flex;
      flex-direction: column;
      align-items: center;
      min-height: 100vh;
      justify-content: flex-start;
      padding: calc(env(safe-area-inset-top) + 40px) 20px calc(env(safe-area-inset-bottom) + 20px);
      gap: 20px;
      overflow-x: hidden;
      -webkit-tap-highlight-color: transparent;
    }

    .btn {
      width: 90%;
      max-width: 250px;
      border-radius: 28px;
      overflow: hidden;
      box-shadow: 0 10px 25px rgba(0,0,0,.25);
      cursor: pointer;
      transition: transform .15s ease;
      background: rgba(255,255,255,0.1);
    }
    .btn:active { transform: scale(0.96); }
    .btn img { width: 100%; height: auto; display: block; }

    .title {
      text-align: center;
      font-weight: 600;
      margin-top: 8px;
      margin-bottom: 12px;
      color: #fff;
      font-size: 16px;
      padding: 0 10px;
    }

    footer {
      margin-top: auto;
      padding-top: 20px;
      width: 100%;
      text-align: center;
      font-size: 12px;
      color: rgba(255,255,255,0.8);
    }

    /* =====================
       POPUP G√âN√âRIQUE
    ===================== */
    .overlay {
      position: fixed;
      inset: 0;
      background: rgba(0,0,0,0.65);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 9999;
      padding: 20px;
    }

    .popup-box {
      background: #fff;
      color: #111;
      border-radius: 20px;
      padding: 18px 18px;
      max-width: 460px;
      width: 100%;
      max-height: 92svh;
      overflow-y: auto;
      font-size: 14px;
    }

    .popup-box h2 {
      margin: 0 0 6px;
      font-size: 20px;
      color: #2196a6;
      text-align: center;
    }
    .popup-box p { margin: 10px 0; line-height: 1.55; }

    /* =====================
       WIZARD BIENVENUE
    ===================== */
    .wiz-step { display: none; }
    .wiz-step.active { display: block; }

    .wiz-progress {
      background: #e0f4f7;
      border-radius: 4px;
      height: 4px;
      margin-bottom: 12px;
      overflow: hidden;
    }
    .wiz-progress-fill {
      height: 100%;
      background: linear-gradient(90deg, #4FB3C2, #2196a6);
      transition: width .3s ease;
    }

    .choice-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 12px;
      margin-top: 14px;
    }

    .choice-card {
      border: 2px solid #e0f4f7;
      border-radius: 14px;
      padding: 14px 10px;
      text-align: center;
      cursor: pointer;
      transition: border-color .2s, background .2s;
      font-size: 13px;
      line-height: 1.4;
    }
    .choice-card:hover { border-color: #4FB3C2; background: #f0fbfc; }
    .choice-card.selected { border-color: #2196a6; background: #e0f4f7; }
    .choice-card .icon { font-size: 28px; margin-bottom: 6px; }
    .choice-card strong { display: block; font-size: 14px; margin-bottom: 4px; color: #2196a6; }

    .explain-box {
      margin-top: 14px;
      border-radius: 12px;
      padding: 14px;
      font-size: 13px;
      line-height: 1.55;
      display: none;
    }
    .explain-box.annuel { background: #fff8e1; border-left: 4px solid #f9a825; }
    .explain-box.mensuel { background: #e8f5e9; border-left: 4px solid #43a047; }
    .explain-box h3 { margin: 0 0 8px; font-size: 14px; }

    .wiz-btn {
      display: block;
      width: 100%;
      padding: 13px;
      border: none;
      border-radius: 12px;
      font-size: 15px;
      font-weight: 600;
      cursor: pointer;
      margin-top: 12px;
      transition: opacity .15s;
    }
    .wiz-btn:active { opacity: 0.8; }
    .wiz-btn.primary { background: linear-gradient(135deg, #4FB3C2, #2196a6); color: #fff; }
    .wiz-btn.secondary { background: #f0f0f0; color: #444; }
    .wiz-btn.go-annuel { background: linear-gradient(135deg, #f9a825, #e65100); color: #fff; }
    .wiz-btn.go-mensuel { background: linear-gradient(135deg, #43a047, #1b5e20); color: #fff; }

    .legal-note {
      font-size: 11px;
      color: #888;
      text-align: center;
      margin-top: 10px;
      line-height: 1.4;
    }

    /* =====================
       POPUP PR√âSENTATION
    ===================== */
    .presentation-box {
      background: #fff;
      color: #000;
      border-radius: 16px;
      padding: 20px;
      max-width: 700px;
      width: 100%;
      text-align: left;
      font-size: 14px;
      max-height: 80vh;
      overflow-y: auto;
    }
    .presentation-box h2, .presentation-box h3 { color: #4FB3C2; margin-top: 15px; }

    .close-btn {
      margin-top: 15px;
      padding: 12px 16px;
      border: none;
      border-radius: 12px;
      background: #4FB3C2;
      color: #fff;
      font-size: 14px;
      width: 100%;
      cursor: pointer;
    }

    .backup-advice {
      font-size: 13px;
      color: #fff;
      text-align: center;
      opacity: 0.9;
      max-width: 320px;
      line-height: 1.4;
    }

    .info-btn {
      background: transparent;
      border: 2px solid rgba(255,255,255,0.9);
      color: #fff;
      padding: 10px 18px;
      border-radius: 22px;
      font-size: 14px;
      cursor: pointer;
      transition: background .15s ease;
    }
    .info-btn:hover { background: rgba(255,255,255,0.15); }
    hr { border: 0; border-top: 1px solid #eee; margin: 15px 0; }
  </style>

</head>

<body>

<!-- =====================
     WIZARD BIENVENUE (1√®re ouverture)
===================== -->

<div class="overlay" id="welcomeWizard">
  <div class="popup-box">

```
<div class="wiz-progress">
  <div class="wiz-progress-fill" id="wizProg" style="width:33%"></div>
</div>

<!-- √âtape 1 : Bienvenue -->
<div class="wiz-step active" id="wStep1">
  <h2>üëã Bienvenue !</h2>
  <p style="text-align:center;color:#555;font-size:13px;margin:8px 0">
    Outil personnel de suivi des heures suppl√©mentaires.<br>
    Aucune donn√©e n'est transmise ‚Äî tout reste sur votre appareil.
  </p>
  <hr style="margin:10px 0">
  <p style="font-size:12px;color:#555;margin:8px 0;line-height:1.5">
    ‚ö†Ô∏è Calculs <strong>indicatifs</strong> ‚Äî seul le bulletin de paie fait foi.<br>
    Pensez √† exporter r√©guli√®rement vos donn√©es.
  </p>
  <button class="wiz-btn primary" onclick="goStep(2)" style="margin-top:10px">Commencer ‚Üí</button>
</div>

<!-- √âtape 2 : Quelle situation ? -->
<div class="wiz-step" id="wStep2">
  <h2>üéØ Votre situation</h2>
  <p style="text-align:center;color:#555;font-size:13px;margin-bottom:4px">
    Comment sont pay√©es vos heures suppl√©mentaires ?
  </p>

  <div class="choice-grid">
    <div class="choice-card" id="cardAnnuel" onclick="selectMode('annuel')">
      <div class="icon">üìä</div>
      <strong>Compteur annuel</strong>
      Suivi sur une ann√©e compl√®te, cl√¥ture en fin d'exercice
    </div>
    <div class="choice-card" id="cardMensuel" onclick="selectMode('mensuel')">
      <div class="icon">üìÖ</div>
      <strong>Paie mensuelle</strong>
      Heures pay√©es chaque mois, avec report automatique
    </div>
  </div>

  <!-- Explication annuel -->
  <div class="explain-box annuel" id="explainAnnuel">
    <h3>üìä Compteur annuel</h3>
    <p>
      Vos heures s'accumulent sur toute une ann√©e (exercice).
      Le solde est sold√© ou pay√© en fin d'exercice.<br><br>
      ‚úÖ Adapt√© si votre entreprise utilise un <strong>compteur de modulation annuelle</strong>
      ou si vos heures sup ne sont pas pay√©es chaque mois.
    </p>
    <button class="wiz-btn go-annuel" onclick="goApp('heures')">
      Ouvrir le compteur annuel ‚Üí
    </button>
  </div>

  <!-- Explication mensuel -->
  <div class="explain-box mensuel" id="explainMensuel">
    <h3>üìÖ Simulateur mensuel</h3>
    <p>
      Chaque mois a sa propre cl√¥ture (ex : dernier dimanche).
      Les heures non pay√©es sont report√©es au mois suivant.<br><br>
      ‚úÖ Adapt√© si vous √™tes <strong>salari√© pay√© chaque fin de mois</strong>
      avec r√®glement partiel ou total des heures suppl√©mentaires.
    </p>
    <button class="wiz-btn go-mensuel" onclick="goApp('paye')">
      Ouvrir le simulateur mensuel ‚Üí
    </button>
  </div>

  <button class="wiz-btn secondary" onclick="goStep(3)" style="margin-top:16px">
    Je veux voir les deux outils ‚Üí
  </button>
  <p class="legal-note">Vous pourrez changer d'outil √† tout moment depuis ce menu.</p>
</div>

<!-- √âtape 3 : Voir les deux -->
<div class="wiz-step" id="wStep3">
  <h2>‚úÖ Tout est pr√™t</h2>
  <p style="text-align:center;font-size:13px;color:#555">
    Les deux simulateurs sont accessibles depuis le menu principal.
  </p>
  <div style="background:#f0fbfc;border-radius:12px;padding:14px;margin-top:10px;font-size:13px">
    <p style="margin:0 0 8px"><strong>üìä Compteur annuel</strong><br>Accumulation sur l'exercice, solde en fin d'ann√©e.</p>
    <hr>
    <p style="margin:0"><strong>üìÖ Simulateur mensuel</strong><br>Cl√¥ture chaque mois, report automatique des reliquats.</p>
  </div>
  <button class="wiz-btn primary" onclick="closeWizard()">Acc√©der au menu ‚Üí</button>
</div>
```

  </div>
</div>

<!-- =====================
     POPUP PR√âSENTATION
===================== -->

<div class="overlay" id="presentationPopup" style="display:none;">
  <div class="presentation-box" onclick="event.stopPropagation()">
    <h2>üì¶ Pr√©sentation du projet</h2>
    <p><b>Simulateur d'heures suppl√©mentaires</b><br>√âcosyst√®me PWA ‚Äì D√©velopp√© par <b>C. Anthony</b></p>
    <hr>
    <h3>üéØ Objectif g√©n√©ral</h3>
    <p>Outil personnel de simulation permettant de visualiser et organiser des heures suppl√©mentaires √† titre <b>strictement indicatif</b>.</p>
    <p>Il ne s'agit ni d'un logiciel de paie, ni d'un document officiel.</p>
    <hr>
    <h3>üìä Compteur annuel</h3>
    <p>Suivi sur un exercice complet. Id√©al pour les modulations annuelles ou les compteurs d'heures sold√©s en fin d'exercice.</p>
    <hr>
    <h3>üìÖ Simulateur mensuel</h3>
    <p>Cl√¥ture mensuelle avec report automatique. Id√©al pour les salari√©s pay√©s chaque mois avec r√®glement partiel des heures suppl√©mentaires.</p>
    <hr>
    <h3>üíæ Donn√©es & fonctionnement</h3>
    <p>Toutes les donn√©es sont stock√©es <b>localement</b> sur votre appareil. Aucun serveur, aucune transmission externe.</p>
    <button class="close-btn" onclick="closePresentation()">Fermer</button>
  </div>
</div>

<!-- =====================
     MENU PRINCIPAL
===================== -->

<div class="btn" onclick="go('heures')">
  <img src="images/renard-annuel.png.jpg" loading="lazy" alt="Compteur annuel">
  <div class="title">Simulateur de compteur annuel</div>
</div>

<div class="btn" onclick="go('paye')">
  <img src="images/renard-mensuel.png.jpg" loading="lazy" alt="Paye mensuelle">
  <div class="title">Simulateur d'heures mensualis√©es</div>
</div>

<div class="btn" onclick="go('fox')">
  <img src="images/renard-central.png.jpg" loading="lazy" alt="Module central">
  <div class="title">Fox player</div>
</div>

<button class="info-btn" onclick="openPresentation()">üìÑ Pr√©sentation du projet</button>
<button class="info-btn" onclick="reopenWizard()">üîÅ Revoir l‚Äôaide au choix</button>

<div class="backup-advice">
  üíæ <strong>Conseil sauvegarde</strong><br>
  Effectuez des <strong>exports r√©guliers</strong> (JSON/PDF) pour √©viter toute perte de donn√©es.
</div>

<footer>D√©velopp√© par C. Anthony</footer>

<script>
  if ("serviceWorker" in navigator) {
    window.addEventListener("load", () => {
      navigator.serviceWorker.register("./sw.js").catch(err => console.log("SW erreur", err));
    });
  }

  // Scroll lock iOS
  let _scrollY = 0;
  function lockScroll() {
    _scrollY = window.scrollY;
    document.body.style.overflow = "hidden";
    document.body.style.position = "fixed";
    document.body.style.top = "-" + _scrollY + "px";
    document.body.style.width = "100%";
  }
  function unlockScroll() {
    document.body.style.overflow = "";
    document.body.style.position = "";
    document.body.style.top = "";
    document.body.style.width = "";
    window.scrollTo(0, _scrollY);
  }

  // Afficher le wizard seulement √† la premi√®re ouverture
  if (localStorage.getItem("menuWizardDone") === "1") {
    document.getElementById("welcomeWizard").style.display = "none";
  } else {
    lockScroll();
  }

  let selectedMode = null;

  function goStep(n) {
    document.querySelectorAll(".wiz-step").forEach(el => el.classList.remove("active"));
    document.getElementById("wStep" + n).classList.add("active");
    const prog = { 1: "33%", 2: "66%", 3: "100%" };
    document.getElementById("wizProg").style.width = prog[n] || "33%";
  }

  function selectMode(mode) {
    selectedMode = mode;
    document.getElementById("cardAnnuel").classList.toggle("selected", mode === "annuel");
    document.getElementById("cardMensuel").classList.toggle("selected", mode === "mensuel");
    document.getElementById("explainAnnuel").style.display = mode === "annuel" ? "block" : "none";
    document.getElementById("explainMensuel").style.display = mode === "mensuel" ? "block" : "none";
  }

  function closeWizard() {
    localStorage.setItem("menuWizardDone", "1");
    document.getElementById("welcomeWizard").style.display = "none";
    unlockScroll();
  }

  function reopenWizard() {
    lockScroll();
    selectedMode = null;
    document.getElementById("cardAnnuel").classList.remove("selected");
    document.getElementById("cardMensuel").classList.remove("selected");
    document.getElementById("explainAnnuel").style.display = "none";
    document.getElementById("explainMensuel").style.display = "none";
    goStep(1);
    document.getElementById("welcomeWizard").style.display = "flex";
  }

  function goApp(app) {
    closeWizard();
    go(app);
  }

  function openPresentation() {
    document.getElementById("presentationPopup").style.display = "flex";
    lockScroll();
  }

  function closePresentation() {
    document.getElementById("presentationPopup").style.display = "none";
    unlockScroll();
  }

  function go(app) {
    localStorage.setItem("lastApp", app);
    window.location.href = app + "/index.html";
  }
</script>

</body>
</html>
